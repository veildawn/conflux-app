# Conflux 汇流 - 用户使用手册

欢迎使用 Conflux 汇流！这是一款现代化的跨平台代理管理应用。本手册将帮助您快速上手并充分利用汇流的各项功能。

---

## 目录

1. [快速开始](#快速开始)
2. [界面概览](#界面概览)
3. [功能模块详解](#功能模块详解)
   - [活动监控](#1-活动监控)
   - [策略管理](#2-策略管理)
   - [策略组管理](#3-策略组管理)
   - [服务器管理](#4-服务器管理)
   - [配置管理](#5-配置管理)
   - [规则管理](#6-规则管理)
   - [资源管理](#7-资源管理)
   - [Sub-Store](#8-sub-store)
   - [日志查看](#9-日志查看)
   - [设置](#10-设置)
4. [常见问题](#常见问题)
5. [术语表](#术语表)

---

## 快速开始

### 第一步：添加配置

1. 打开 Conflux 应用
2. 点击左侧边栏的「**配置**」
3. 点击右上角「**添加配置**」按钮
4. 选择配置类型：
   - **远程订阅**：输入您从代理服务商获得的订阅链接
   - **本地文件**：导入本地的配置文件
   - **空白配置**：从零开始手动创建配置

### 第二步：激活配置

添加配置后，点击配置卡片即可激活。激活的配置会显示蓝色边框和指示点。

### 第三步：开始使用

配置激活后，代理核心会自动启动。您可以在「活动」页面查看当前状态，在「策略」页面选择代理节点。

---

## 界面概览

Conflux 采用现代化的侧边栏布局：

```
┌─────────────────────────────────────────────┐
│  标题栏（可拖动窗口）                          │
├────────┬────────────────────────────────────┤
│        │                                    │
│  侧    │                                    │
│  边    │         主要内容区域                 │
│  栏    │                                    │
│        │                                    │
├────────┴────────────────────────────────────┤
│  底部状态栏                                   │
└─────────────────────────────────────────────┘
```

**侧边栏菜单说明：**

| 图标 | 名称      | 功能                   |
| ---- | --------- | ---------------------- |
| 📊   | 活动      | 实时流量监控和核心状态 |
| 🌐   | 策略      | 切换代理模式和选择节点 |
| 📁   | 策略组    | 管理节点分组           |
| 🖥️   | 服务器    | 管理代理服务器         |
| 📋   | 配置      | 管理订阅和配置文件     |
| 🛡️   | 规则      | 设置流量分流规则       |
| 📦   | 资源      | 管理外部代理源和规则源 |
| 🏪   | Sub-Store | 高级订阅管理工具       |
| 📜   | 日志      | 查看运行日志           |
| ⚙️   | 设置      | 应用设置               |

---

## 功能模块详解

### 1. 活动监控

**路径**：侧边栏 → 活动

这是 Conflux 的主页，为您展示代理核心的实时运行状态。

#### 功能介绍

| 区块         | 说明                                           |
| ------------ | ---------------------------------------------- |
| **核心状态** | 显示代理核心版本、运行状态、端口信息和当前模式 |
| **上传速度** | 实时上传速度和趋势图                           |
| **下载速度** | 实时下载速度和趋势图                           |
| **连接数**   | 当前活跃的网络连接数量                         |
| **总流量**   | 累计上传和下载流量统计                         |

#### 操作说明

- **重启核心**：点击核心状态卡片右下角的刷新按钮可以重启代理核心
- 如果核心状态显示「已停止」，请检查是否有激活的配置

---

### 2. 策略管理

**路径**：侧边栏 → 策略

策略页面是您日常使用最多的地方，用于切换代理模式和选择使用哪个节点。

#### 代理模式

Conflux 支持三种代理模式：

| 模式     | 说明                 | 适用场景                           |
| -------- | -------------------- | ---------------------------------- |
| **规则** | 根据预设规则智能分流 | 日常使用推荐，国内直连、国外走代理 |
| **全局** | 所有流量都走代理     | 需要全部流量代理时使用             |
| **直连** | 所有流量不经过代理   | 临时关闭代理时使用                 |

#### 策略组

页面会显示所有可用的策略组卡片，点击卡片可以查看组内节点并进行选择。

**策略组类型说明：**

- **手动选择**：需要您手动选择使用哪个节点
- **自动选择**：系统会自动选择延迟最低的节点
- **负载均衡**：流量会分散到多个节点

#### 操作步骤

1. 在页面顶部选择代理模式（规则/全局/直连）
2. 点击策略组卡片查看节点列表
3. 在弹出的面板中点击「测速全部」测试节点延迟
4. 点击您想使用的节点即可切换

> 💡 **提示**：绿色延迟表示速度快（<200ms），黄色表示中等，红色表示较慢或超时

---

### 3. 策略组管理

**路径**：侧边栏 → 策略组

此页面用于管理配置中的策略组，可以创建、编辑和删除策略组。

#### 什么是策略组？

策略组是一组代理节点的集合，您可以根据需要创建不同用途的分组，例如：

- 「视频」组：包含适合看视频的节点
- 「游戏」组：包含低延迟的游戏节点
- 「备用」组：包含备用节点

#### 操作说明

| 操作           | 说明                                           |
| -------------- | ---------------------------------------------- |
| **新建策略组** | 点击右上角「新建策略组」按钮                   |
| **编辑策略组** | 点击列表中策略组右侧的编辑按钮                 |
| **删除策略组** | 点击删除按钮（如果策略组被规则引用则无法删除） |

#### 创建策略组步骤

1. 点击「新建策略组」
2. 选择策略组类型（手动选择/自动选择/负载均衡等）
3. 输入名称
4. 选择要包含的节点
5. 根据需要配置高级选项
6. 点击保存

---

### 4. 服务器管理

**路径**：侧边栏 → 服务器

管理配置文件中的所有代理服务器节点。

#### 功能介绍

- 查看所有服务器节点及其类型（SS、VMess、Trojan 等）
- 测试节点延迟
- 添加、编辑、删除节点

#### 添加服务器

点击「添加服务器」按钮，有两种方式：

**方式一：解析链接**

1. 选择「解析链接」
2. 粘贴节点分享链接（如 `ss://...`、`vmess://...` 等）
3. 系统会自动解析并添加节点

**方式二：手动添加**

1. 选择「手动添加」
2. 选择协议类型
3. 填写服务器地址、端口、密码等信息
4. 点击保存

#### 延迟测速

- **单个测速**：鼠标悬停在节点卡片上，点击闪电图标
- **批量测速**：点击「测速全部」按钮

> ⚠️ **注意**：测速功能需要核心已启动才能使用

---

### 5. 配置管理

**路径**：侧边栏 → 配置

这是管理代理配置文件的核心页面。一个配置包含了节点、规则、策略组等所有代理设置。

#### 配置类型

| 类型         | 图标 | 说明                      |
| ------------ | ---- | ------------------------- |
| **远程订阅** | 🌐   | 从 URL 自动获取和更新配置 |
| **本地配置** | 📄   | 从本地文件导入的配置      |
| **空白配置** | 📁   | 手动创建的空白配置        |

#### 添加配置

1. 点击「添加配置」
2. 选择配置类型
3. 根据类型填写信息：
   - 远程订阅：输入名称和订阅 URL
   - 本地文件：选择本地的 YAML 配置文件
   - 空白配置：只需输入名称

#### 配置操作

| 操作     | 说明                                       |
| -------- | ------------------------------------------ |
| **激活** | 点击配置卡片激活该配置                     |
| **更新** | 点击刷新按钮更新远程订阅（仅远程订阅可用） |
| **导出** | 将配置导出为 YAML 文件                     |
| **编辑** | 修改配置名称或 URL                         |
| **删除** | 删除该配置                                 |

> 💡 **提示**：配置卡片上会显示节点数量和规则数量，方便您了解配置内容

---

### 6. 规则管理

**路径**：侧边栏 → 规则

规则决定了哪些网站/应用走代理、哪些直连。这是实现智能分流的核心。

#### 规则工作原理

当您访问一个网站时，Conflux 会按照规则列表从上到下匹配：

1. 匹配到第一条规则后，使用该规则指定的策略
2. 如果没有匹配任何规则，使用最后的 MATCH 规则

#### 规则类型说明

| 类型               | 说明               | 示例                             |
| ------------------ | ------------------ | -------------------------------- |
| **DOMAIN**         | 精确匹配域名       | `DOMAIN,google.com,Proxy`        |
| **DOMAIN-SUFFIX**  | 匹配域名后缀       | `DOMAIN-SUFFIX,google.com,Proxy` |
| **DOMAIN-KEYWORD** | 匹配域名关键词     | `DOMAIN-KEYWORD,google,Proxy`    |
| **GEOIP**          | 按 IP 地理位置匹配 | `GEOIP,CN,DIRECT`                |
| **GEOSITE**        | 按网站分类匹配     | `GEOSITE,google,Proxy`           |
| **IP-CIDR**        | 匹配 IP 地址段     | `IP-CIDR,192.168.0.0/16,DIRECT`  |
| **RULE-SET**       | 使用规则集         | `RULE-SET,my-rules,Proxy`        |
| **MATCH**          | 兜底规则，匹配所有 | `MATCH,Proxy`                    |

#### 常用策略

| 策略       | 说明                       |
| ---------- | -------------------------- |
| **DIRECT** | 直接连接，不走代理         |
| **REJECT** | 拒绝连接（常用于广告拦截） |
| **Proxy**  | 使用代理（指向策略组）     |

#### 操作说明

- **添加规则**：点击「添加规则」按钮
- **编辑规则**：点击规则行
- **删除规则**：点击规则右侧的删除按钮
- **排序规则**：拖动规则左侧的手柄调整顺序

> ⚠️ **重要**：规则顺序很重要！越靠前的规则优先级越高。

---

### 7. 资源管理

**路径**：侧边栏 → 资源

管理外部的代理源（Proxy Provider）和规则源（Rule Provider），实现配置的模块化管理。

#### 代理源

代理源是一个外部的节点列表文件，可以：

- 从远程 URL 自动获取节点
- 从本地文件加载节点
- 定期自动更新

**添加代理源步骤：**

1. 切换到「代理源」标签
2. 点击「添加代理源」
3. 填写名称、URL 和更新间隔
4. 可选：配置健康检查

#### 规则源

规则源是一个外部的规则列表文件，用于：

- 引用第三方维护的规则集
- 简化配置管理
- 自动更新规则

**规则源行为类型：**

| 类型          | 说明                     |
| ------------- | ------------------------ |
| **domain**    | 仅包含域名规则           |
| **ipcidr**    | 仅包含 IP 地址规则       |
| **classical** | 传统格式，可包含各种规则 |

---

### 8. Sub-Store

**路径**：侧边栏 → Sub-Store

Sub-Store 是一个强大的订阅管理工具，内置在 Conflux 中。

#### 功能特点

- 🔄 订阅转换：将各种格式的订阅转换为通用格式
- ✂️ 节点筛选：按关键词、正则表达式筛选节点
- 🏷️ 节点重命名：批量修改节点名称
- 🔗 订阅合并：将多个订阅合并为一个
- ⏰ 自动更新：定时刷新订阅

#### 使用场景

- 订阅链接格式不兼容时进行转换
- 需要从多个订阅中筛选特定节点
- 想要自定义节点名称格式
- 合并多个机场的订阅

> 💡 **提示**：Sub-Store 功能较为高级，新手用户可以暂时跳过

---

### 9. 日志查看

**路径**：侧边栏 → 日志

实时查看代理核心的运行日志，便于排查问题。

#### 日志级别

| 级别        | 颜色 | 说明     |
| ----------- | ---- | -------- |
| **DEBUG**   | 灰色 | 调试信息 |
| **INFO**    | 蓝色 | 一般信息 |
| **WARNING** | 黄色 | 警告信息 |
| **ERROR**   | 红色 | 错误信息 |

#### 功能操作

| 操作     | 说明                   |
| -------- | ---------------------- |
| **搜索** | 在日志中搜索关键词     |
| **过滤** | 按日志级别过滤         |
| **暂停** | 暂停日志滚动，方便查看 |
| **导出** | 将日志导出为文本文件   |
| **清空** | 清除当前显示的日志     |

> 💡 **提示**：遇到问题时，查看 ERROR 和 WARNING 级别的日志可以快速定位问题

---

### 10. 设置

**路径**：侧边栏 → 设置

配置 Conflux 的各项参数。

#### 通用设置

| 选项           | 说明                           |
| -------------- | ------------------------------ |
| **界面语言**   | 当前仅支持简体中文             |
| **当前版本**   | 显示应用和核心版本，可检查更新 |
| **开机自启动** | 开机时自动启动 Conflux         |
| **项目主页**   | 访问 GitHub 项目页面           |

#### 网络设置

| 选项           | 说明                         | 默认值 |
| -------------- | ---------------------------- | ------ |
| **HTTP 端口**  | HTTP 代理监听端口            | 7890   |
| **SOCKS 端口** | SOCKS5 代理监听端口          | 7891   |
| **Mixed 端口** | 混合协议端口                 | -      |
| **局域网共享** | 允许其他设备使用代理         | 关闭   |
| **TUN 模式**   | 虚拟网卡模式（需管理员权限） | 关闭   |
| **IPv6**       | 启用 IPv6 支持               | 关闭   |
| **TCP 并发**   | 优化连接速度                 | 关闭   |

#### TUN 模式说明

TUN 模式创建虚拟网卡，可以让所有应用的流量都经过代理，无需为每个应用单独配置。

**协议栈选项：**

- **System**：使用系统网络栈，兼容性最好
- **gVisor**：用户态网络栈，性能好
- **Mixed**：混合模式

> ⚠️ **注意**：启用 TUN 模式需要管理员权限，首次启用时系统会请求授权

#### DNS 设置

配置 DNS 服务器和相关选项，高级用户可根据需要调整。

---

## 常见问题

### Q1: 代理不生效怎么办？

**检查清单：**

1. 确认核心状态为「运行中」
2. 确认已激活一个配置
3. 检查系统代理设置是否正确
4. 尝试切换到「全局」模式测试

### Q2: 节点全部超时怎么办？

**解决方案：**

1. 检查网络连接是否正常
2. 更新订阅获取最新节点
3. 联系您的服务商确认服务状态
4. 尝试更换其他节点

### Q3: 如何让某个应用不走代理？

**方法一：添加规则**

1. 进入「规则」页面
2. 添加该应用域名的规则，策略设为 DIRECT

**方法二：使用 TUN 模式**
TUN 模式下可以更精细地控制哪些应用走代理

### Q4: 如何共享代理给其他设备？

1. 进入「设置」→「网络」
2. 开启「局域网共享」
3. 在其他设备上设置代理为：`您的电脑IP:7890`

### Q5: 配置文件在哪里？

Conflux 的配置文件存储在：

- **macOS**: `~/Library/Application Support/com.conflux.desktop/`
- **Windows**: `%APPDATA%\com.conflux.desktop\`

---

## 术语表

| 术语         | 解释                                   |
| ------------ | -------------------------------------- |
| **代理核心** | 负责处理网络流量的后端程序（MiHomo）   |
| **订阅**     | 包含代理节点信息的 URL，可自动更新     |
| **节点**     | 代理服务器，也称为「服务器」或「线路」 |
| **策略组**   | 一组节点的集合，支持多种选择策略       |
| **规则**     | 定义哪些流量走哪个策略的条件           |
| **延迟**     | 网络往返时间，单位毫秒(ms)，越小越快   |
| **TUN**      | 虚拟网卡技术，实现透明代理             |
| **SOCKS5**   | 一种代理协议，支持 TCP 和 UDP          |
| **直连**     | 不经过代理，直接连接目标服务器         |

---

## 需要帮助？

如果您在使用过程中遇到问题：

1. 📖 查看本手册的「常见问题」部分
2. 📜 检查「日志」页面的错误信息
3. 🐛 在 [GitHub Issues](https://github.com/veildawn/conflux-app/issues) 提交问题
4. 💬 加入社区讨论

---

_最后更新：2024年1月_
